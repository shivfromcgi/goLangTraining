# Go Language Training - Unified Assignments

This project combines Assignment 1 and Assignment 2 from the CGI Go Academy course into a single, unified codebase. Instead of having separate projects, you can run different assignments by specifying command-line flags.

## Project Structure

```
OpenMedia_GoLang_Course/
├── main.go              # Unified main application
├── go.mod               # Go module file with dependencies
├── storage/             # Storage package from Assignment 2
│   ├── storage.go       # File operations with structured logging
│   └── storage_test.go  # Unit tests for storage package
├── messages.txt         # Generated by Assignment 1 (message storage)
└── README.md           # This file
```

## Features

### Assignment 1: Message System
- Add user messages to a persistent file
- View the last 10 messages
- Clear all messages
- Simple CLI interface

### Assignment 2: Advanced Storage System
- Structured logging with JSON format (log/slog)
- Context-based tracing with UUID
- Graceful shutdown with signal handling
- Modular storage package
- Comprehensive unit tests

### Assignment 3: HTTP JSON API
- REST API with ServeMux for routing
- JSON message creation and retrieval endpoints
- HTTP middleware for TraceID injection
- Integration with existing message storage
- Structured JSON responses with error handling

## Usage

### Running Assignment 1 (Message System)

```bash
# Add a message
go run main.go -assignment=assignment1 -user=alice -message="Hello World"

# Add another message
go run main.go -assignment=assignment1 -user=bob -message="How are you?"

# Clear all messages
go run main.go -assignment=assignment1 -clear

# View usage help
go run main.go
```

### Running Assignment 2 (Advanced Storage)

```bash
# Run with default settings
go run main.go -assignment=assignment2

# Run with custom file and data
go run main.go -assignment=assignment2 -file=custom.txt -data="My custom content"

# The program will run until you press Ctrl+C
```

### Running Assignment 3 (HTTP JSON API)

```bash
# Start HTTP server on default port (8080)
go run main.go -assignment=assignment3

# Start HTTP server on custom port
go run main.go -assignment=assignment3 -port=9090

# The server will run until you press Ctrl+C
```

#### API Endpoints:

```bash
# Health check
curl http://localhost:8080/health

# Create a message
curl -X POST http://localhost:8080/messages \
  -H "Content-Type: application/json" \
  -d '{"user":"alice","message":"Hello API!"}'

# Get all messages
curl http://localhost:8080/messages

# Example responses include TraceID for request tracing
```

## Testing

```bash
# Run all tests
go test ./... -v

# Run storage package tests only
go test ./storage -v

# Run tests with coverage
go test ./storage -cover
```

## Build Commands

```bash
# Build for current platform
go build -o gotraining main.go

# Build for Linux
GOOS=linux GOARCH=amd64 go build -o gotraining-linux main.go

# Build for Windows
GOOS=windows GOARCH=amd64 go build -o gotraining.exe main.go
```

## Key Improvements in Unified Version

1. **Single Entry Point**: One `main.go` file handles both assignments
2. **Command-line Selection**: Use `-assignment` flag to choose which functionality to run
3. **Shared Dependencies**: Common dependencies in single `go.mod`
4. **Consistent Error Handling**: Unified error handling patterns
5. **Clear Documentation**: Usage instructions built into the application

## Dependencies

- `github.com/google/uuid` - UUID generation for tracing
- `github.com/stretchr/testify` - Testing framework

## Assignment Details

### Assignment 1 Features
- Persistent message storage in `messages.txt`
- User identification for each message
- Last 10 messages display
- Clear functionality

### Assignment 2 Features
- Structured JSON logging
- Context-based request tracing
- Signal handling (SIGINT/SIGTERM)
- Modular storage package
- File read/write operations
- Comprehensive unit tests with testify

### Assignment 3 Features
- HTTP REST API using net/http ServeMux
- JSON message creation and retrieval
- TraceID middleware for request tracing
- Integration with message storage from Assignment 1
- Structured JSON responses with error handling
- Health check endpoint
- Graceful server shutdown

## Examples

```bash
# Complete workflow for Assignment 1
go run main.go -assignment=assignment1 -user=alice -message="Starting the day"
go run main.go -assignment=assignment1 -user=bob -message="Good morning Alice"
go run main.go -assignment=assignment1 -user=alice -message="Good morning Bob"
# View messages by running any message command
# Clear when done:
go run main.go -assignment=assignment1 -clear

# Complete workflow for Assignment 2
go run main.go -assignment=assignment2 -file=demo.txt -data="Demo content" &
# Wait a few seconds, then:
kill -INT <process_id>
```

This unified approach demonstrates how to build scalable Go applications that can grow from simple scripts to complex systems while maintaining clean architecture and code reusability.